!function(){var a;a=function(){function a(){this.defaultInterceptor=["$q",function(a){return{success:function(a){return a},error:function(b){return a.reject(b)}}}],this.defaultActions={get:{method:"get"},create:{method:"post"},save:{method:function(a){return null!=(null!=a?a.id:void 0)?"put":"post"}},update:{method:"put"},destroy:{method:"delete"},query:{method:"get",isArray:!0,filter:function(a,b,c){var d,e;for(d in c)if(e=c[d],!angular.equals(a[d],e))return!1;return!0}}}}return a.prototype.setUrl=function(a){this.url=a},a.prototype.setMock=function(a){this.mock=a},a.prototype.setDefaultActions=function(a){this.defaultActions=a},a.prototype.setDefaultInterceptor=function(a){this.defaultInterceptor=a},a.prototype.$get=function(a){var b;return b=["$injector","$window","$rootScope","$q"],this.mock&&b.push("spinnakerMock"),b.push(this.service.bind(this)),a.invoke(b)},a.prototype.service=function(a,b,c,d,e){var f,g,h,i,j,k,l=this;return g=null!=(i=null!=(j=this.url)?j:null!=(k=b.location)?k.origin:void 0)?i:"http://localhost:1337",h=null!=e?e:b.io.connect(g),f=a.invoke(this.defaultInterceptor),function(a,b,e){var g,i,j,k,m,n,o,p,q,r,s,t,u;null==b&&(b="/"+a+"/:id"),e=angular.extend({},l.defaultActions,e);for(m in e)j=e[m],null==j.interceptor&&(j.interceptor={}),null==(s=j.interceptor).success&&(s.success=f.success),null==(t=j.interceptor).error&&(t.error=f.error);o=function(a,b){var c,d;for(c in b)d=b[c],null!=d&&(a=a.replace(":"+c,d));return a=a.replace(/\/?:\w+/g,""),a.replace(/\/$/,"")},p=function(a,b,e){var f;return null==b&&(b={}),null==e&&(e="get"),f=d.defer(),h[e](a,b,function(a){return c.$apply(function(){return null!=a.status?f.reject(a):f.resolve(a)})}),f.promise},k=function(a){return function(c,e,f,h){var j,k,l,m,n,q,r,s,t,u,v,w,x;return u=function(){switch(arguments.length){case 4:return[c,e,f,h];case 3:case 2:return angular.isFunction(e)?angular.isFunction(c)?[null,null,c,e]:[c,null,e,f]:[c,e,f,h];case 1:return angular.isFunction(c)?[null,null,c,null]:[c,null,null,null];default:return[null,null,null,null]}}.apply(this,arguments),n=u[0],j=u[1],s=u[2],k=u[3],l=this instanceof g,null==n&&(n=l?this:{}),m=null!=(v=a.method)?v:"get",angular.isFunction(a.method)&&(m=a.method(n)),/^(POST|PUT|PATCH|DELETE)$/i.test(m)&&null==j&&(j=n),r=null!=(w=a.resource)?w:g,t=a.isArray?new i(r,n,j,a.filter):l?this:new r(j),q=p(o(null!=(x=a.url)?x:b,n),j,m).then(function(b){var c,d,e;if(null!=b)if(a.isArray)for(t.length=0,d=0,e=b.length;e>d;d++)c=b[d],t.push(new r(c).subscribe());else q=t.$promise,angular.copy(b,t),t.$promise=q;return t.$resolved=!0,t.subscribe(),null!=s&&s(t),t},function(a){return t.$resolved=!0,null!=k&&k(a),d.reject(a)}),q=q.then(a.interceptor.success,a.interceptor.error),l?q:(t.$promise=q,t.$resolved=!1,t)}},q=function(){return this.unsubscribe(),this._subscription=this._msgHandler.bind(this),h.on("message",this._subscription),this},r=function(){return null!=this._subscription&&h.removeListener("message",this._subscription),this._subscription=null,this},i=function(a,b,d,e){var f;return null==e&&(e=function(){return!0}),f=new Array,f.subscribe=q.bind(f),f.unsubscribe=r.bind(f),f._msgHandler=function(g){return g.model!==a.model?!1:"create"!==g.verb||e(g.data,b,d)?c.$apply(function(){var c,h,i,j,k,l,m,n,o,p,q,r;switch(g.verb){case"create":return f.push(new a(g.data).subscribe());case"destroy":for(j=[],h=k=0,n=f.length;n>k;h=++k)i=f[h],null!=(null!=i?i.id:void 0)&&i.id===g.id&&(j.push(h),i.unsubscribe());for(q=[],l=0,o=j.length;o>l;l++)h=j[l],q.push(f.splice(h,1));return q;case"update":if(c=function(){var a,b,c;for(c=[],h=a=0,b=f.length;b>a;h=++a)i=f[h],null!=(null!=i?i.id:void 0)&&i.id===g.id&&c.push(h);return c}(),!e(g.data,b,d)){for(r=[],m=0,p=c.length;p>m;m++)h=c[m],r.push(f.splice(h,1));return r}if(0===c.length)return f.push(new a(g.data).subscribe())}}):!1},f},g=function(){function b(a){null!=a&&angular.copy(a,this)}var d;b.model=a;for(d in e)j=e[d],b[d]=k(j);return b.prototype.subscribe=q,b.prototype.unsubscribe=r,b.prototype._msgHandler=function(a){var b=this;return a.model===this.constructor.model&&a.id===this.id&&"update"===a.verb?c.$apply(function(){return null!=a.data?angular.copy(a.data,b):void 0}):void 0},b}(),u=function(a){return g.prototype[a]=function(){var b,c;return b=g[a].bind(this).apply(null,arguments),null!=(c=b.$promise)?c:b}};for(n in e)j=e[n],u(n,j);return g}},a}(),angular.module("spinnaker",[]).provider("spinnaker",a)}.call(this);